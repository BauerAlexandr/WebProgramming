{% extends 'base.html' %}
{% load static %}

{% block title %}{{ watch.title }} - GoldenHands{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/styles.css' %}">
<div class="watch-detail-modern">
    <div class="watch-detail-flex">
        <div class="watch-detail-main">
            <h1 class="watch-detail-title">{{ watch.title }}</h1>
            <img src="{{ watch.image.url }}" alt="{{ watch.title }}" class="watch-detail-image">
        </div>
        <div class="watch-detail-side">
            <div class="watch-detail-actions">
                <a href="{% url 'edit_watch' watch.slug %}" class="btn-edit-watch">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                <a href="{% url 'delete_watch' watch.slug %}" class="btn-delete-watch">–£–¥–∞–ª–∏—Ç—å</a>
            </div>
            <div class="watch-detail-info"><b>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</b> {{ watch.category.name }}</div>
            <div class="watch-detail-info"><b>–¶–µ–Ω–∞:</b> {{ watch.price|floatformat:2 }} ‚ÇΩ</div>
            <div class="watch-detail-info"><b>–¢–µ–≥–∏:</b>
                {% for tag in watch.tags.all %}
                    <span class="watch-detail-tag">{{ tag.name }}</span>
                {% endfor %}
            </div>
            <div class="watch-detail-info"><b>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:</b><br>
                {% if watch.tech_spec %}
                    –ú–µ—Ö–∞–Ω–∏–∑–º - {{ watch.tech_spec.mechanism }}<br>
                    –í–æ–¥–æ–∑–∞—â–∏—Ç–∞ - {{ watch.tech_spec.water_resistance }}<br>
                    –ú–∞—Ç–µ—Ä–∏–∞–ª –∫–æ—Ä–ø—É—Å–∞ - {{ watch.tech_spec.case_material }}
                {% endif %}
            </div>
            <div class="watch-detail-likes">
                <a href="{% url 'like_action' watch.slug 'like' %}" class="like-btn">üëç <span>{{ like_count }}</span></a>
                <a href="{% url 'like_action' watch.slug 'dislike' %}" class="dislike-btn">üëé <span>{{ dislike_count }}</span></a>
            </div>
            {% if user.is_authenticated %}
                <a href="{% url 'add_to_cart' watch.slug %}" class="btn-add-to-cart">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</a>
            {% else %}
                <p class="warning">–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É.</p>
            {% endif %}
        </div>
    </div>
    <div class="watch-detail-description-block">
        <h2 class="watch-detail-section-title">–û–ø–∏—Å–∞–Ω–∏–µ</h2>
        <div class="watch-detail-description">{{ watch.description|linebreaks }}</div>
    </div>
    <div class="watch-detail-comments-block">
        <h2 class="watch-detail-section-title">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h2>
        <div class="watch-detail-comments-list">
            {% if comments %}
                {% for comment in comments %}
                    <div class="watch-detail-comment">
                        <div class="watch-detail-comment-avatar">
                            {% if comment.author.photo %}
                                <img src="{{ comment.author.photo.url }}" alt="{{ comment.author.username }}'s avatar" class="watch-detail-comment-avatar-img">
                            {% else %}
                                <img src="{% static 'images/default.png' %}" alt="Default avatar" class="watch-detail-comment-avatar-img">
                            {% endif %}
                        </div>
                        <div class="watch-detail-comment-content">
                            <div class="watch-detail-comment-author">{{ comment.author.username }} <span class="watch-detail-comment-date">({{ comment.created_at|date:'d.m.Y H:i' }})</span></div>
                            <div class="watch-detail-comment-text">{{ comment.text|linebreaks }}</div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="watch-detail-no-comments">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –µ—â–µ –Ω–µ—Ç.</div>
            {% endif %}
        </div>
        <form method="post" action="{% url 'add_comment_watch' slug=watch.slug %}" class="watch-detail-comment-form">
            {% csrf_token %}
            <textarea name="text" rows="3" placeholder="–û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" class="watch-detail-comment-textarea"></textarea>
            <button type="submit" class="watch-detail-comment-btn">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</button>
        </form>
    </div>
</div>
{% endblock %}